{"version":3,"file":"elsa-client-DrY-Mv8P.js","sources":["src/modules/elsa-webhooks/services/elsa-client.ts"],"sourcesContent":["import { HttpClient, createFetchHttpClient } from '../../../services/http/fetch-client';\nimport * as collection from 'lodash/collection';\nimport {eventBus} from '../../../services/event-bus';\nimport {EventTypes, PagedList} from \"../../../models\";\nimport {WebhookDefinition, WebhookDefinitionSummary} from \"../models\";\n\nlet _httpClient: HttpClient = null;\nlet _elsaWebhooksClient: ElsaWebhooksClient = null;\n\nexport const createHttpClient = async function(baseAddress: string) : Promise<HttpClient> {\n  if(!!_httpClient)\n    return _httpClient;\n  _httpClient = await createFetchHttpClient(baseAddress);\n  return _httpClient;\n}\n\nexport const createElsaWebhooksClient = async function (serverUrl: string): Promise<ElsaWebhooksClient> {\n\n  if (!!_elsaWebhooksClient)\n    return _elsaWebhooksClient;\n\n  const httpClient: HttpClient = _httpClient ?? await createHttpClient(serverUrl);\n\n  _elsaWebhooksClient = {\n    webhookDefinitionsApi: {\n      list: async (page?: number, pageSize?: number) => {\n        const response = await httpClient.get<PagedList<WebhookDefinitionSummary>>(`v1/webhook-definitions`);\n        return response.data;\n      },\n      getByWebhookId: async (webhookId: string) => {\n        const response = await httpClient.get<WebhookDefinition>(`v1/webhook-definitions/${webhookId}`);\n        return response.data;\n      },\n      save: async request => {\n        const response = await httpClient.post<WebhookDefinition>('v1/webhook-definitions', request);\n        return response.data;\n      },\n      update: async request => {\n        const response = await httpClient.put<WebhookDefinition>('v1/webhook-definitions', request);\n        return response.data;\n      },\n      delete: async webhookId => {\n        await httpClient.delete(`v1/webhook-definitions/${webhookId}`);\n      },\n    }\n  }\n\n  return _elsaWebhooksClient;\n}\n\nexport interface ElsaWebhooksClient {\n  webhookDefinitionsApi: WebhookDefinitionsApi;\n}\n\nexport interface WebhookDefinitionsApi {\n\n  list(page?: number, pageSize?: number): Promise<PagedList<WebhookDefinitionSummary>>;\n\n  getByWebhookId(webhookId: string): Promise<WebhookDefinition>;\n\n  save(request: SaveWebhookDefinitionRequest): Promise<WebhookDefinition>;\n\n  update(request: SaveWebhookDefinitionRequest): Promise<WebhookDefinition>;\n\n  delete(webhookId: string): Promise<void>;\n}\n\nexport interface SaveWebhookDefinitionRequest {\n  id?: string;\n  name?: string;\n  path?: string;\n  description?: string;\n  payloadTypeName?: string;\n  isEnabled?: boolean;\n}\n"],"names":[],"mappings":";;AAMA,IAAI,WAAW,GAAe,IAAI;AAClC,IAAI,mBAAmB,GAAuB,IAAI;AAE3C,MAAM,gBAAgB,GAAG,gBAAe,WAAmB,EAAA;IAChE,IAAG,CAAC,CAAC,WAAW;AACd,QAAA,OAAO,WAAW;AACpB,IAAA,WAAW,GAAG,MAAM,qBAAqB,CAAC,WAAW,CAAC;AACtD,IAAA,OAAO,WAAW;AACpB,CAAC;AAEY,MAAA,wBAAwB,GAAG,gBAAgB,SAAiB,EAAA;IAEvE,IAAI,CAAC,CAAC,mBAAmB;AACvB,QAAA,OAAO,mBAAmB;IAE5B,MAAM,UAAU,GAAe,WAAW,KAAA,IAAA,IAAX,WAAW,KAAA,KAAA,CAAA,GAAX,WAAW,GAAI,MAAM,gBAAgB,CAAC,SAAS,CAAC;AAE/E,IAAA,mBAAmB,GAAG;AACpB,QAAA,qBAAqB,EAAE;AACrB,YAAA,IAAI,EAAE,OAAO,IAAa,EAAE,QAAiB,KAAI;gBAC/C,MAAM,QAAQ,GAAG,MAAM,UAAU,CAAC,GAAG,CAAsC,CAAwB,sBAAA,CAAA,CAAC;gBACpG,OAAO,QAAQ,CAAC,IAAI;aACrB;AACD,YAAA,cAAc,EAAE,OAAO,SAAiB,KAAI;gBAC1C,MAAM,QAAQ,GAAG,MAAM,UAAU,CAAC,GAAG,CAAoB,CAA0B,uBAAA,EAAA,SAAS,CAAE,CAAA,CAAC;gBAC/F,OAAO,QAAQ,CAAC,IAAI;aACrB;AACD,YAAA,IAAI,EAAE,OAAM,OAAO,KAAG;gBACpB,MAAM,QAAQ,GAAG,MAAM,UAAU,CAAC,IAAI,CAAoB,wBAAwB,EAAE,OAAO,CAAC;gBAC5F,OAAO,QAAQ,CAAC,IAAI;aACrB;AACD,YAAA,MAAM,EAAE,OAAM,OAAO,KAAG;gBACtB,MAAM,QAAQ,GAAG,MAAM,UAAU,CAAC,GAAG,CAAoB,wBAAwB,EAAE,OAAO,CAAC;gBAC3F,OAAO,QAAQ,CAAC,IAAI;aACrB;AACD,YAAA,MAAM,EAAE,OAAM,SAAS,KAAG;gBACxB,MAAM,UAAU,CAAC,MAAM,CAAC,0BAA0B,SAAS,CAAA,CAAE,CAAC;aAC/D;AACF;KACF;AAED,IAAA,OAAO,mBAAmB;AAC5B;;;;"}