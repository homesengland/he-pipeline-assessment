{"version":3,"file":"elsa-workflow-registry-list-screen.entry.esm.js","sources":["src/components/screens/workflow-registry-list/elsa-workflow-registry-list-screen/elsa-workflow-registry-list-screen.tsx"],"sourcesContent":["import {Component, h, Prop, State, Event} from '@stencil/core';\nimport * as collection from 'lodash/collection';\nimport {eventBus, createElsaClient} from \"../../../../services\";\nimport {\n  EventTypes,\n  PagedList,\n  VersionOptions,\n  WorkflowBlueprintSummary,\n  ConfigureWorkflowRegistryColumnsContext,\n  ConfigureWorkflowRegistryUpdatingContext,\n  WorkflowProviderDescriptor\n} from \"../../../../models\";\nimport {MenuItem} from \"../../../controls/elsa-context-menu/models\";\nimport {injectHistory, LocationSegments, RouterHistory} from \"@stencil/router\";\nimport Tunnel from \"../../../../data/dashboard\";\nimport {DropdownButtonItem, DropdownButtonOrigin} from \"../../../controls/elsa-dropdown-button/models\";\nimport {parseQuery} from \"../../../../utils/utils\";\nimport {PagerData} from \"../../../controls/elsa-pager/elsa-pager\";\n\n@Component({\n  tag: 'elsa-workflow-registry-list-screen',\n  shadow: false,\n})\nexport class ElsaWorkflowRegistryListScreen {\n  static readonly DEFAULT_PAGE_SIZE = 5;\n  static readonly MIN_PAGE_SIZE = 5;\n  static readonly MAX_PAGE_SIZE = 100;\n  static readonly START_PAGE = 0;\n\n  @Prop() public history?: RouterHistory;\n  @Prop() public serverUrl: string;\n  @Prop() public basePath: string;\n  @Prop() public culture: string;\n  @State() private currentProviderName: string = \"ProgrammaticWorkflowProvider\";\n  @State() private workflowProviders: Array<WorkflowProviderDescriptor> = [];\n  @State() private workflowBlueprints: PagedList<WorkflowBlueprintSummary> = {items: [], page: 1, pageSize: 50, totalCount: 0};\n\n  @State() private currentPage: number = 0;\n  @State() private currentPageSize: number = ElsaWorkflowRegistryListScreen.DEFAULT_PAGE_SIZE;\n  @State() private currentSearchTerm?: string;\n\n  private confirmDialog: HTMLElsaConfirmDialogElement;\n\n  private unlistenRouteChanged: () => void;\n\n  private workflowRegistryColumns: ConfigureWorkflowRegistryColumnsContext = {\n    data: null\n  };\n\n  async componentWillLoad() {\n    await this.loadWorkflowProviders();\n\n    if (!!this.history)\n      this.applyQueryString(this.history.location.search);\n\n\n    await this.loadWorkflowBlueprints();\n    await eventBus.emit(EventTypes.WorkflowRegistryLoadingColumns, this, this.workflowRegistryColumns);\n  }\n\n  connectedCallback() {\n    if (!!this.history)\n      this.unlistenRouteChanged = this.history.listen(e => this.routeChanged(e));\n\n    eventBus.on(EventTypes.WorkflowUpdated, this.onLoadWorkflowBlueprints);\n    eventBus.on(EventTypes.WorkflowRegistryUpdated, this.onLoadWorkflowBlueprints);\n  }\n\n  disconnectedCallback() {\n    if (!!this.unlistenRouteChanged)\n      this.unlistenRouteChanged();\n\n    eventBus.detach(EventTypes.WorkflowUpdated, this.onLoadWorkflowBlueprints);\n    eventBus.detach(EventTypes.WorkflowRegistryUpdated, this.onLoadWorkflowBlueprints);\n  }\n\n  private applyQueryString(queryString?: string) {\n    const query = parseQuery(queryString);\n\n    if(!!query.provider)\n      this.currentProviderName = query.provider;\n\n    this.currentPage = !!query.page ? parseInt(query.page) : 0;\n    this.currentPage = isNaN(this.currentPage) ? ElsaWorkflowRegistryListScreen.START_PAGE : this.currentPage;\n    this.currentPageSize = !!query.pageSize ? parseInt(query.pageSize) : ElsaWorkflowRegistryListScreen.DEFAULT_PAGE_SIZE;\n    this.currentPageSize = isNaN(this.currentPageSize) ? ElsaWorkflowRegistryListScreen.DEFAULT_PAGE_SIZE : this.currentPageSize;\n    this.currentPageSize = Math.max(Math.min(this.currentPageSize, ElsaWorkflowRegistryListScreen.MAX_PAGE_SIZE), ElsaWorkflowRegistryListScreen.MIN_PAGE_SIZE);\n  }\n\n  private async routeChanged(e: LocationSegments) {\n\n    if (!e.pathname.toLowerCase().endsWith('workflow-registry'))\n      return;\n\n    this.applyQueryString(e.search);\n    await this.loadWorkflowBlueprints();\n  }\n\n  private async onDisableWorkflowClick(e: Event, workflowBlueprintId: string) {\n    const result = await this.confirmDialog.show('Disable Workflow', 'Are you sure you wish to disable this workflow?');\n\n    if (!result)\n      return;\n\n    await this.updateFeature(workflowBlueprintId, 'disabled', 'true');\n  }\n\n  private async onEnableWorkflowClick(e: Event, workflowBlueprintId: string) {\n    const result = await this.confirmDialog.show('Enable Workflow', 'Are you sure you wish to enable this workflow?');\n\n    if (!result)\n      return;\n\n    await this.updateFeature(workflowBlueprintId, 'disabled', 'false');\n  }\n\n  private async updateFeature(workflowBlueprintId: string, key: string, value: string) {\n    const workflowRegistryUpdating: ConfigureWorkflowRegistryUpdatingContext = {\n      params: [workflowBlueprintId, key, value]\n    };\n    await eventBus.emit(EventTypes.WorkflowRegistryUpdating, this, workflowRegistryUpdating);\n  }\n\n  private async onLoadWorkflowBlueprints() {\n    await this.loadWorkflowBlueprints();\n  }\n\n  private onPaged = async (e: CustomEvent<PagerData>) => {\n    this.currentPage = e.detail.page;\n    await this.loadWorkflowBlueprints();\n  };\n\n  private async onWorkflowProviderChanged(value: string) {\n    this.currentProviderName = value;\n    this.currentPage = 0;\n    await this.loadWorkflowBlueprints();\n  }\n\n  private async loadWorkflowProviders() {\n    const elsaClient = await this.createClient();\n    this.workflowProviders = await elsaClient.workflowProvidersApi.list();\n    this.currentProviderName = this.workflowProviders.length > 0 ? this.workflowProviders[0].name : undefined;\n  }\n\n  private async loadWorkflowBlueprints() {\n    const elsaClient = await this.createClient();\n    const page = this.currentPage;\n    const pageSize = this.currentPageSize;\n    const versionOptions: VersionOptions = {isLatest: true};\n    const providerName = this.currentProviderName;\n    this.workflowBlueprints = await elsaClient.workflowRegistryApi.list(providerName, page, pageSize, versionOptions);\n  }\n\n  createClient() {\n    return createElsaClient(this.serverUrl);\n  }\n\n  render() {\n    const workflowBlueprints = this.workflowBlueprints.items;\n    const totalCount = this.workflowBlueprints.totalCount;\n    const groupings = collection.groupBy(workflowBlueprints, 'id');\n    const basePath = this.basePath;\n\n    let headers = this.workflowRegistryColumns.data != null ? this.workflowRegistryColumns.data.headers : [];\n    let hasFeatureContextItems = this.workflowRegistryColumns.data != null ? this.workflowRegistryColumns.data.hasContextItems : false;\n\n    const renderFeatureHeader = (item: any) => {\n      return (<th\n        class=\"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-right elsa-uppercase elsa-tracking-wider\">{item[0]}</th>)\n    }\n\n    const renderFeatureColumn = (item: any, isWorkflowBlueprintDisabled: boolean) => {\n      return (<td\n        class=\"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right\">{isWorkflowBlueprintDisabled ? 'No' : 'Yes'}</td>)\n    }\n\n    const renderContextMenu = (\n      workflowBlueprintId: string,\n      isWorkflowBlueprintDisabled: boolean,\n      history: RouterHistory,\n      editUrl: string,\n      editIcon: any,\n      enableIcon: any,\n      disableIcon: any) => {\n\n      let menuItems: MenuItem[] = [];\n      menuItems = [...menuItems, ...[{text: 'Edit', anchorUrl: editUrl, icon: editIcon}]];\n\n      if (hasFeatureContextItems) {\n        if (isWorkflowBlueprintDisabled)\n          menuItems = [...menuItems, ...[{\n            text: 'Enable',\n            clickHandler: e => this.onEnableWorkflowClick(e, workflowBlueprintId),\n            icon: enableIcon\n          }]];\n        else\n          menuItems = [...menuItems, ...[{\n            text: 'Disable',\n            clickHandler: e => this.onDisableWorkflowClick(e, workflowBlueprintId),\n            icon: disableIcon\n          }]];\n      }\n      return (<td class=\"elsa-pr-6\">\n        <elsa-context-menu history={history} menuItems={menuItems}/>\n      </td>)\n    }\n\n    return (\n      <div>\n\n        <div class=\"elsa-p-8 elsa-flex elsa-content-end elsa-justify-right elsa-bg-white elsa-space-x-4\">\n          <div class=\"elsa-flex-shrink-0\">\n            {this.renderWorkflowProviderFilter()}\n          </div>\n        </div>\n\n        <div class=\"elsa-align-middle elsa-inline-block elsa-min-w-full elsa-border-b elsa-border-gray-200\">\n          <table class=\"elsa-min-w-full\">\n            <thead>\n            <tr class=\"elsa-border-t elsa-border-gray-200\">\n              <th\n                class=\"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-left elsa-uppercase elsa-tracking-wider\"><span\n                class=\"lg:elsa-pl-2\">Name</span></th>\n              <th\n                class=\"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-left elsa-uppercase elsa-tracking-wider\">\n                Instances\n              </th>\n              <th\n                class=\"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-right elsa-uppercase elsa-tracking-wider\">\n                Latest Version\n              </th>\n              <th\n                class=\"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-right elsa-uppercase elsa-tracking-wider\">\n                Published Version\n              </th>\n              {headers.map(item => renderFeatureHeader(item))}\n              <th\n                class=\"elsa-pr-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-text-left elsa-uppercase elsa-tracking-wider\"/>\n            </tr>\n            </thead>\n            <tbody class=\"elsa-bg-white elsa-divide-y elsa-divide-gray-100\">\n            {collection.map(groupings, group => {\n              const versions = collection.orderBy(group, 'version', 'desc');\n              const workflowBlueprint: WorkflowBlueprintSummary = versions[0];\n              const latestVersionNumber = workflowBlueprint.version;\n              const publishedVersion: WorkflowBlueprintSummary = versions.find(x => x.isPublished);\n              const publishedVersionNumber = !!publishedVersion ? publishedVersion.version : '-';\n              let workflowDisplayName = workflowBlueprint.displayName;\n\n              if (!workflowDisplayName || workflowDisplayName.trim().length == 0)\n                workflowDisplayName = workflowBlueprint.name;\n\n              if (!workflowDisplayName || workflowDisplayName.trim().length == 0)\n                workflowDisplayName = '(Untitled)';\n\n              const editUrl = `${basePath}/workflow-registry/${workflowBlueprint.id}`;\n              const instancesUrl = `${basePath}/workflow-instances?workflow=${workflowBlueprint.id}`;\n\n              const editIcon = (\n                <svg class=\"elsa-h-5 elsa-w-5 elsa-text-gray-500\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"\n                     xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"\n                     stroke-linecap=\"round\"\n                     stroke-linejoin=\"round\">\n                  <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"/>\n                  <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"/>\n                </svg>\n              );\n\n              const enableIcon = (\n                <svg class=\"elsa-h-5 elsa-w-5 elsa-text-gray-500\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"\n                     stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n                  <path stroke=\"none\" d=\"M0 0h24v24H0z\"/>\n                  <path d=\"M5 12l5 5l10 -10\"/>\n                </svg>\n              );\n\n              const disableIcon = (\n                <svg class=\"elsa-h-5 elsa-w-5 elsa-text-gray-500\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"\n                     stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n                  <path stroke=\"none\" d=\"M0 0h24v24H0z\"/>\n                  <circle cx=\"12\" cy=\"12\" r=\"9\"/>\n                  <line x1=\"5.7\" y1=\"5.7\" x2=\"18.3\" y2=\"18.3\"/>\n                </svg>\n              );\n\n              return (\n                <tr>\n                  <td\n                    class=\"elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-font-medium elsa-text-gray-900\">\n                    <div class=\"elsa-flex elsa-items-center elsa-space-x-3 lg:elsa-pl-2\">\n                      <elsa-nav-link url={editUrl} anchorClass=\"elsa-truncate hover:elsa-text-gray-600\">\n                        <span>{workflowDisplayName}</span></elsa-nav-link>\n                    </div>\n                  </td>\n\n                  <td class=\"elsa-px-6 elsa-py-3 elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-font-medium\">\n                    <div class=\"elsa-flex elsa-items-center elsa-space-x-3 lg:elsa-pl-2\">\n                      <elsa-nav-link url={instancesUrl}\n                                          anchorClass=\"elsa-truncate hover:elsa-text-gray-600\">Instances\n                      </elsa-nav-link>\n                    </div>\n                  </td>\n\n                  <td\n                    class=\"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right\">{latestVersionNumber}</td>\n                  <td\n                    class=\"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right\">{publishedVersionNumber}</td>\n                  {headers.map(item => renderFeatureColumn(item, workflowBlueprint.isDisabled))}\n                  {renderContextMenu(workflowBlueprint.id, workflowBlueprint.isDisabled, this.history, editUrl, editIcon, enableIcon, disableIcon)}\n                </tr>\n              );\n            })}\n            </tbody>\n          </table>\n          <elsa-pager page={this.currentPage} pageSize={this.currentPageSize} totalCount={totalCount} history={this.history} onPaged={this.onPaged} culture={this.culture}/>\n        </div>\n\n        <elsa-confirm-dialog ref={el => this.confirmDialog = el}/>\n      </div>\n    );\n  }\n\n  renderWorkflowProviderFilter() {\n\n    const items: Array<DropdownButtonItem> = this.workflowProviders.map(x => ({text: x.displayName, value: x.name}));\n    const selectedProvider = this.workflowProviders.find(x => x.name == this.currentProviderName);\n    const selectedProviderText = selectedProvider?.displayName || '';\n\n    const renderIcon = function () {\n      return <svg class=\"elsa-mr-3 elsa-h-5 elsa-w-5 elsa-text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n        <path stroke=\"none\" d=\"M0 0h24v24H0z\"/>\n        <rect x=\"4\" y=\"4\" width=\"6\" height=\"6\" rx=\"1\"/>\n        <rect x=\"14\" y=\"4\" width=\"6\" height=\"6\" rx=\"1\"/>\n        <rect x=\"4\" y=\"14\" width=\"6\" height=\"6\" rx=\"1\"/>\n        <rect x=\"14\" y=\"14\" width=\"6\" height=\"6\" rx=\"1\"/>\n      </svg>;\n    };\n\n    return <elsa-dropdown-button\n      text={selectedProviderText} items={items} icon={renderIcon()}\n      origin={DropdownButtonOrigin.TopRight}\n      onItemSelected={e => this.onWorkflowProviderChanged(e.detail.value)}/>\n  }\n}\n\nTunnel.injectProps(ElsaWorkflowRegistryListScreen, ['serverUrl', 'culture', 'basePath']);\ninjectHistory(ElsaWorkflowRegistryListScreen);\n"],"names":["collection.groupBy","collection.map","collection.orderBy"],"mappings":"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"}