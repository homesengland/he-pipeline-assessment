{"version":3,"file":"stencil-route-switch.entry.esm.js","sources":["node_modules/@stencil/router/dist/collection/components/switch/switch.js"],"sourcesContent":["import { h } from '@stencil/core';\r\nimport ActiveRouter from '../../global/active-router';\r\nimport { matchPath } from '../../utils/match-path';\r\nconst getUniqueId = () => {\r\n    return ((Math.random() * 10e16).toString().match(/.{4}/g) || []).join('-');\r\n};\r\nconst getMatch = (pathname, url, exact) => {\r\n    return matchPath(pathname, {\r\n        path: url,\r\n        exact: exact,\r\n        strict: true\r\n    });\r\n};\r\nconst isHTMLStencilRouteElement = (elm) => {\r\n    return elm.tagName === 'STENCIL-ROUTE';\r\n};\r\nexport class RouteSwitch {\r\n    constructor() {\r\n        this.group = getUniqueId();\r\n        this.subscribers = [];\r\n    }\r\n    componentWillLoad() {\r\n        if (this.location != null) {\r\n            this.regenerateSubscribers(this.location);\r\n        }\r\n    }\r\n    async regenerateSubscribers(newLocation) {\r\n        if (newLocation == null) {\r\n            return;\r\n        }\r\n        let newActiveIndex = -1;\r\n        this.subscribers = Array.prototype.slice.call(this.el.children)\r\n            .filter(isHTMLStencilRouteElement)\r\n            .map((childElement, index) => {\r\n            const match = getMatch(newLocation.pathname, childElement.url, childElement.exact);\r\n            if (match && newActiveIndex === -1) {\r\n                newActiveIndex = index;\r\n            }\r\n            return {\r\n                el: childElement,\r\n                match: match\r\n            };\r\n        });\r\n        if (newActiveIndex === -1) {\r\n            return;\r\n        }\r\n        // Check if this actually changes which child is active\r\n        // then just pass the new match down if the active route isn't changing.\r\n        if (this.activeIndex === newActiveIndex) {\r\n            this.subscribers[newActiveIndex].el.match = this.subscribers[newActiveIndex].match;\r\n            return;\r\n        }\r\n        this.activeIndex = newActiveIndex;\r\n        // Set all props on the new active route then wait until it says that it\r\n        // is completed\r\n        const activeChild = this.subscribers[this.activeIndex];\r\n        if (this.scrollTopOffset) {\r\n            activeChild.el.scrollTopOffset = this.scrollTopOffset;\r\n        }\r\n        activeChild.el.group = this.group;\r\n        activeChild.el.match = activeChild.match;\r\n        activeChild.el.componentUpdated = (routeViewUpdatedOptions) => {\r\n            // After the new active route has completed then update visibility of routes\r\n            this.queue.write(() => {\r\n                this.subscribers.forEach((child, index) => {\r\n                    child.el.componentUpdated = undefined;\r\n                    if (index === this.activeIndex) {\r\n                        return child.el.style.display = '';\r\n                    }\r\n                    if (this.scrollTopOffset) {\r\n                        child.el.scrollTopOffset = this.scrollTopOffset;\r\n                    }\r\n                    child.el.group = this.group;\r\n                    child.el.match = null;\r\n                    child.el.style.display = 'none';\r\n                });\r\n            });\r\n            if (this.routeViewsUpdated) {\r\n                this.routeViewsUpdated(Object.assign({ scrollTopOffset: this.scrollTopOffset }, routeViewUpdatedOptions));\r\n            }\r\n        };\r\n    }\r\n    render() {\r\n        return (h(\"slot\", null));\r\n    }\r\n    static get is() { return \"stencil-route-switch\"; }\r\n    static get properties() { return {\r\n        \"group\": {\r\n            \"type\": \"string\",\r\n            \"mutable\": false,\r\n            \"complexType\": {\r\n                \"original\": \"string\",\r\n                \"resolved\": \"string\",\r\n                \"references\": {}\r\n            },\r\n            \"required\": false,\r\n            \"optional\": false,\r\n            \"docs\": {\r\n                \"tags\": [],\r\n                \"text\": \"\"\r\n            },\r\n            \"attribute\": \"group\",\r\n            \"reflect\": true,\r\n            \"defaultValue\": \"getUniqueId()\"\r\n        },\r\n        \"scrollTopOffset\": {\r\n            \"type\": \"number\",\r\n            \"mutable\": false,\r\n            \"complexType\": {\r\n                \"original\": \"number\",\r\n                \"resolved\": \"number | undefined\",\r\n                \"references\": {}\r\n            },\r\n            \"required\": false,\r\n            \"optional\": true,\r\n            \"docs\": {\r\n                \"tags\": [],\r\n                \"text\": \"\"\r\n            },\r\n            \"attribute\": \"scroll-top-offset\",\r\n            \"reflect\": false\r\n        },\r\n        \"location\": {\r\n            \"type\": \"unknown\",\r\n            \"mutable\": false,\r\n            \"complexType\": {\r\n                \"original\": \"LocationSegments\",\r\n                \"resolved\": \"LocationSegments | undefined\",\r\n                \"references\": {\r\n                    \"LocationSegments\": {\r\n                        \"location\": \"import\",\r\n                        \"path\": \"../../global/interfaces\"\r\n                    }\r\n                }\r\n            },\r\n            \"required\": false,\r\n            \"optional\": true,\r\n            \"docs\": {\r\n                \"tags\": [],\r\n                \"text\": \"\"\r\n            }\r\n        },\r\n        \"routeViewsUpdated\": {\r\n            \"type\": \"unknown\",\r\n            \"mutable\": false,\r\n            \"complexType\": {\r\n                \"original\": \"(options: RouteViewOptions) => void\",\r\n                \"resolved\": \"((options: RouteViewOptions) => void) | undefined\",\r\n                \"references\": {\r\n                    \"RouteViewOptions\": {\r\n                        \"location\": \"import\",\r\n                        \"path\": \"../../global/interfaces\"\r\n                    }\r\n                }\r\n            },\r\n            \"required\": false,\r\n            \"optional\": true,\r\n            \"docs\": {\r\n                \"tags\": [],\r\n                \"text\": \"\"\r\n            }\r\n        }\r\n    }; }\r\n    static get contextProps() { return [{\r\n            \"name\": \"queue\",\r\n            \"context\": \"queue\"\r\n        }]; }\r\n    static get elementRef() { return \"el\"; }\r\n    static get watchers() { return [{\r\n            \"propName\": \"location\",\r\n            \"methodName\": \"regenerateSubscribers\"\r\n        }]; }\r\n}\r\nActiveRouter.injectProps(RouteSwitch, [\r\n    'location',\r\n    'routeViewsUpdated'\r\n]);\r\n"],"names":[],"mappings":"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","x_google_ignoreList":[0]}